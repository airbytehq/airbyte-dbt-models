# Recurly Airbyte dbt Package

---

- This package contains dbt models to work with the Airbyte Recurly connector.
- It is compatible with the latest version of the Airbyte Recurly connector.
- Currently, it focuses on creating transformations compatible with [Fivetran's modeling dbt package](https://github.com/fivetran/dbt_recurly).
- In the future, specific models will be applied directly to the Airbyte connector output. If you have an idea or want to propose an analytical model for this source, please refer to the contributing guide, which explains how to propose a new transformation model.
- This package was tested with BigQuery, Snowflake, and Postgres data warehouses.

---

## ðŸŽ¯ Instructions on How to Use

### Airbyte dbt Package

For now, Airbyte dbt packages aren't versioned. You must configure using git and subdirectory. There aren't any transformation models directly applied to this package yet, but you can generate docs and tests with dbt.

Create the following files:

**`dbt_project.yml`**

```yaml
vars:
  using_fivetran_model: False
  airbyte_database: "airbyte_db_default"
  airbyte_schema: "airbyte_dbt_recurly"
```

**`packages.yml`**

```yaml
packages:
  - git: "https://github.com/airbytehq/airbyte-dbt-models.git"
    subdirectory: "connectors/source_recurly"

  - package: fivetran/recurly
    version: [">=0.16.0", "<0.17.0"]
```

This is a default variable definition you must configure to have the models created.
At the moment this package doesn't support (schedules, domains, user tags, ticket form history and organization tags) for that reason keep those variables set to `False`.
Variables starting with the prefix `recurly_..._identifier` represent the names of tables generated by the Airbyte connector. If you configured your sync with this prefix, ensure you edit it accordingly.

**`dbt_project.yml`**

```yaml
vars:
  # Required by Airbyte dbt model
  using_fivetran_model: True
  airbyte_database: "airbyte_db_default"
  airbyte_schema: "airbyte_dbt_recurly"

  # Required by Fivetran dbt model
  recurly_database: "airbyte_db_default"
  recurly_schema: "airbyte_dbt_recurly"

  recurly__using_credit_payment_history: False
  recurly__using_subscription_add_on_history: False
  recurly__using_subscription_change_history: False 

  recurly_account_note_identifier: "account_notes"
  recurly_account_balance_identifier: "accounts"
  recurly_add_on_identifier: "add_ons"
  recurly_billing_info_identifier: "billing_info"
  recurly_coupon_identifier: "coupons"
  recurly_credit_payment_identifier: "credit_payments"
  recurly_export_date_identifier: "export_dates"
  recurly_invoice_identifier: "invoices"
  recurly_line_item_identifier: "line_items"
  recurly_measured_unit_identifier: "measured_units"
  recurly_plan_identifier: "plans"
  recurly_shipping_address_identifier: "shipping_addresses"
  recurly_shipping_method_identifier: "shipping_methods"
  recurly_subscription_identifier: "subscriptions"
  recurly_transaction_identifier: "transactions"
  recurly_unique_coupon_identifier: "unique_coupons"

```

After run `dbt run`, you can see the models being created.

---

## :package: Package Maintenance

- This package is maintained by the Airbyte Community.
- You can contribute any time please read the Contributing Guidelines or enter the Airbyte Slack Channel `#airbyte-dbt-packages`
