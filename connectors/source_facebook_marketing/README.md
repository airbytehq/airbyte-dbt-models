# Airbyte source_facebook_marketing dbt Package

This package contains dbt models for Airbyte source_facebook_marketing source.

What it includes:

- A complete source description
- ERD model for the source
- Diagram documentation for the source

## ðŸŽ¯ Intructions how to use

### Airbyte dbt Package

For now Airbyte dbt packages aren't versioned. You must configure using git and subdirectory. For now there isn't any transformation model directly applied to this package. But you can generate docs and tests with dbt.

Add the following to your `dbt_project.yml` file:

```yaml
models:
  source_facebook_marketing:
    +materialized: view
    +schema: staging
  facebook_ads_source:
    +materialized: view
    +schema: staging
    tmp:
      +enabled: false # Disable temporary tables as they are created by the source_facebook_marketing models
  facebook_ads:
    +schema: reporting
    intermediate:
      +materialized: ephemeral

vars:
  airbyte_database: postgres
  airbyte_schema: dbt_source_facebook_marketing
```

Add the following to your `packages.yml` file (create it if it does not exist):

```yaml
packages:
  - git: 'https://github.com/airbytehq/airbyte-dbt-models.git'
    subdirectory: 'connectors/source_facebook_marketing'
```

After you can run `dbt docs generate && dbt docs serve` to have a preview of Airbyte output data.

---

### Fivetran Facebook Marketing dbt packages

This package transforms Airbyte connector output data, making it compatible with Fivetran's Facebook Marketing dbt packages. You can check the [source models](https://github.com/fivetran/dbt_facebook_ads_source) and [analytical models](https://github.com/fivetran/dbt_facebook_ads) Fivetran creates. The links also provides information about how the packages works and what is configurable.

This is a default variable definition you must configure to have the models created. At the moment this package doesn't support passing through additional metrics, for that reason do not set those variables. Variables starting in the format `source_facebook_marketing_..._identifier` represent the names of tables generated by the Airbyte connector. If you configured your sync with custom names, prefixes or suffixes, ensure you edit it accordingly.

`dbt_project.yml`

```yaml
vars:
  # [Required] Use these variables to configure your sources if they are loaded in a single database and schema
  airbyte_database: postgres
  airbyte_schema: airbyte_facebook_marketing

  # [Optional] Use these variables to configure your source tables if they are loaded with custom names, prefixes or suffixes (not compatible with union sources)
  source_facebook_marketing_ad_account_identifier: 'fbads_ad_account'
  source_facebook_marketing_ad_sets_identifier: 'fbads_ad_sets'
  source_facebook_marketing_ads_insights_identifier: 'fbads_ads_insights'
  source_facebook_marketing_campaigns_identifier: 'fbads_campaigns'
  source_facebook_marketing_ads_identifier: 'fbads_ads'
  source_facebook_marketing_ad_creatives_identifier: 'fbads_ad_creatives'

  # [Optional] Use these variables to configure your sources if they are loaded in different databases or schemas under default stream names (one of the two options maximum)
  facebook_ads_union_databases: # use this if the data is in different databases/projects but uses the same schema
    - database_us
    - database_ca
  facebook_ads_union_schemas: # use this if the data is in different schemas/datasets of the same database/projectname
    - airbyte_facebook_marketing_us
    - airbyte_facebook_marketing_ca
```

Run `dbt run` to see the models being created.
Run `dbt test` to see the tests being executed.
Run `dbt build` to create the models and execute the tests.

## ðŸ“¦ Package Maintenance

This package is maintained by the Airbyte Community.
You can contribute any time please read the Contributing Guidelines or enter the Airbyte Slack Channel `#airbyte-dbt-packages`
